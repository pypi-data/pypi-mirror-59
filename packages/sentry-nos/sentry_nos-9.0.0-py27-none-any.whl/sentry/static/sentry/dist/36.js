webpackJsonpexports([36],{1612:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"default",function(){return b});var i=n(0),l=n.n(i),s=n(10),c=n(2),u=n(30),p=n(92),f=n(1800),m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),b=function(e){function t(){var e,n,o,i;r(this,t);for(var l=arguments.length,p=Array(l),f=0;f<l;f++)p[f]=arguments[f];return n=o=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(p))),o.deleteRepo=function(e){var t=u.default.add(Object(c.t)("Saving changes.."));o.api.request("/organizations/"+o.props.params.orgId+"/repos/"+e.id+"/",{method:"DELETE",success:function(e){var t=o.state.itemList;t.forEach(function(t){t.id===e.id&&(t.status=e.status)}),o.setState({itemList:t})},error:function(){u.default.add(Object(c.t)("An error occurred."),"error",{duration:3e3})},complete:function(){u.default.remove(t)}})},o.cancelDelete=function(e){var t=u.default.add(Object(c.t)("Saving changes.."));o.api.request("/organizations/"+o.props.params.orgId+"/repos/"+e.id+"/",{method:"PUT",data:{status:"visible"},success:function(e){var t=o.state.itemList;t.forEach(function(t){t.id===e.id&&(t.status=e.status)}),o.setState({itemList:t})},error:function(){u.default.add(Object(c.t)("An error occurred."),"error",{duration:3e3})},complete:function(){u.default.remove(t)}})},o.onAddRepo=function(e){var t=o.state.itemList;t.push(e),o.setState({itemList:Object(s.q)(t,function(e){return e.name})})},i=n,a(o,i)}return o(t,e),d(t,[{key:"getEndpoints",value:function(){var e=this.props.params.orgId;return[["itemList","/organizations/"+e+"/repos/",{query:{status:""}}],["repoConfig","/organizations/"+e+"/config/repos/"]]}},{key:"getTitle",value:function(){return"Repositories"}},{key:"renderBody",value:function(){return l.a.createElement(f.a,m({},this.props,this.state,{onAddRepo:this.onAddRepo,onCancelDelete:this.cancelDelete,onDeleteRepo:this.deleteRepo}))}}]),t}(p.default)},1800:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return k});var i,l,s=n(14),c=n(1),u=n.n(c),p=n(0),f=n.n(p),m=n(5),d=n(2),b=n(26),h=n(119),y=n(37),v=n(44),g=n(127),E=n(18),O=n(52),j=n(81),S=n(1801),_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),w=Object(m.default)(g.a,{target:"e1u0cxz70"})("border-bottom:1px solid ",function(e){return e.theme.borderLight},";&:last-child{border-bottom:none;}"),k=(l=i=function(e){function t(){return r(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),_(t,[{key:"getStatusLabel",value:function(e){switch(e.status){case"pending_deletion":return"Deletion Queued";case"deletion_in_progress":return"Deletion in Progress";case"hidden":return"Disabled";default:return null}}},{key:"render",value:function(){var e=this,t=this.props,n=t.params,r=t.itemList,a=t.repoConfig,o=t.onAddRepo,i=t.onCancelDelete,l=t.onDeleteRepo,c=n.orgId,u=r&&r.length>0;return f.a.createElement("div",null,f.a.createElement(O.default,{title:Object(d.t)("Repositories"),action:f.a.createElement(y.default,{anchorRight:!0,className:"btn btn-primary btn-sm",title:Object(d.t)("Add Repository")},a&&a.providers&&a.providers.map(function(e){return f.a.createElement(v.default,{noAnchor:!0,key:e.id},f.a.createElement(S.a,{provider:e,orgId:c,onSuccess:o}))}))}),!u&&f.a.createElement("div",{className:"m-b-2"},f.a.createElement(j.default,null,Object(d.t)("Connecting a repository allows Sentry to capture commit data via webhooks. This enables features like suggested assignees and resolving issues via commit message. Once you've connected a repository, you can associate commits with releases via the API.")," ",Object(d.tct)("See our [link:documentation] for more details.",{link:f.a.createElement("a",{href:"https://docs.sentry.io/learn/releases/"})}))),u?f.a.createElement(E.a,null,f.a.createElement(E.e,{disablePadding:!0},f.a.createElement(s.Flex,null,f.a.createElement(s.Box,{px:2},Object(d.t)("Added Repositories")))),f.a.createElement(E.c,null,f.a.createElement(s.Box,null,r.map(function(t){var n="active"===t.status;return f.a.createElement(w,{key:t.id},f.a.createElement(s.Box,{p:2,flex:"1"},f.a.createElement(s.Flex,{direction:"column"},f.a.createElement(s.Box,{pb:1},f.a.createElement("strong",null,t.name),!n&&f.a.createElement("small",null," — ",e.getStatusLabel(t)),"pending_deletion"===t.status&&f.a.createElement("small",null," ","(",f.a.createElement("a",{onClick:function(){return i(t)}},Object(d.t)("Cancel")),")")),f.a.createElement(s.Box,null,f.a.createElement("small",null,t.provider.name),t.url&&f.a.createElement("small",null," ","— ",f.a.createElement("a",{href:t.url},t.url))))),f.a.createElement(s.Box,{p:2},f.a.createElement(h.a,{disabled:!n,onConfirm:function(){return l(t)},message:Object(d.t)("Are you sure you want to remove this repository?")},f.a.createElement(b.default,{size:"xsmall"},f.a.createElement("span",{className:"icon icon-trash"})))))})))):f.a.createElement(E.a,{className:"blankslate align-center p-x-2 p-y-1"},f.a.createElement("div",{className:"icon icon-lg icon-git-commit"}),f.a.createElement("h3",null,Object(d.t)("Sentry is better with commit data")),f.a.createElement(j.default,null,Object(d.t)("Adding one or more repositories will enable enhanced releases and the ability to resolve Sentry Issues via git message.")),f.a.createElement("p",{className:"m-b-1"},f.a.createElement("a",{className:"btn btn-default",href:"https://docs.sentry.io/learn/releases/"},"Learn more"))))}}]),t}(f.a.Component),i.propTypes={itemList:u.a.array,repoConfig:u.a.object,onAddRepo:u.a.func,onCancelDelete:u.a.func,onDeleteRepo:u.a.func},l)},1801:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l,s,c=n(64),u=n.n(c),p=n(1),f=n.n(p),m=n(0),d=n.n(m),b=n(55),h=n(10),y=n(2),v=n(420),g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),O={error_type:"unknown"},j=(s=l=function(e){function t(e,n){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return Object.assign(r.state,g({},r.getDefaultState(),{fieldList:null,loading:!0,state:b.FormState.LOADING})),["onOpen","onCancel","formSubmit","changeField"].forEach(function(e){r[e]=r[e].bind(r)}),r}return i(t,e),E(t,[{key:"getDefaultState",value:function(){var e={};return this.props.provider.config.forEach(function(t){t.initial&&(e[t.name]=t.initial)}),{isModalOpen:!1,error:{},formData:e}}},{key:"onOpen",value:function(){this.setState({isModalOpen:!0})}},{key:"onCancel",value:function(){this.setState(this.getDefaultState())}},{key:"formSubmit",value:function(e){e.preventDefault(),this.onSubmit()}},{key:"onSubmit",value:function(){var e=this,t=g({},this.state.formData,{provider:this.props.provider.id});t.name&&(t.name=Object(h.o)(t.name)),this.setState({state:b.FormState.SAVING},function(){e.api.request("/organizations/"+e.props.orgId+"/repos/",{data:t,method:"POST",success:e.onSaveSuccess.bind(e,function(t){e.setState({isModalOpen:!1,formData:{},error:{}}),e.props.onSuccess(t)}),error:e.onSaveError.bind(e,function(t){e.setState({error:t.responseJSON||O||O,state:b.FormState.error})}),complete:e.onSaveComplete})})}},{key:"changeField",value:function(e,t){this.setState(function(n){return{formData:g({},n.formData,r({},e,t))}})}},{key:"renderNote",value:function(e){return!!["integrations:github","integrations:bitbucket"].includes(e.id)&&d.a.createElement("div",{className:"alert alert-info alert-block",style:{display:"flex",alignItems:"center"}},d.a.createElement("p",null,"You must install at least one "+e.name+"  Integration to connect a repository."))}},{key:"renderForm",value:function(){var e=this,t=this.state.error.errors||{},n=this.props.provider,r=!0;return n.config.forEach(function(e){""==e.initial&&(r=!1)}),d.a.createElement("form",{onSubmit:this.formSubmit},t.__all__&&d.a.createElement("div",{className:"alert alert-error alert-block",key:"_errors"},d.a.createElement("p",null,t.__all__)),!r&&this.renderNote(n),n.config.map(function(n){return d.a.createElement("div",{key:n.name},e.renderField({config:n,formData:e.state.formData,formErrors:t,onChange:e.changeField.bind(e,n.name)}))}))}},{key:"renderBody",value:function(){var e=this.state.error;if("auth"===e.error_type){var t=e.auth_url;return-1===t.indexOf("?")?t+="?next="+encodeURIComponent(document.location.pathname):t+="&next="+encodeURIComponent(document.location.pathname),d.a.createElement("div",null,d.a.createElement("div",{className:"alert alert-warning m-b-1"},"You need to associate an identity with "+this.props.provider.name+" before you can create issues with this service."),d.a.createElement("a",{className:"btn btn-primary",href:t},"Associate Identity"))}return e.error_type&&"validation"!==e.error_type?d.a.createElement("div",{className:"alert alert-error alert-block"},d.a.createElement("p",null,e.message?e.message:Object(y.tct)("An unknown error occurred. Need help with this? [link:Contact support]",{link:d.a.createElement("a",{href:"https://sentry.io/support/"})}))):this.renderForm()}},{key:"renderModal",value:function(){var e=this.state,t=e.error,n=e.state;return d.a.createElement(u.a,{show:this.state.isModalOpen,animation:!1},d.a.createElement("div",{className:"modal-header"},d.a.createElement("h4",null,Object(y.t)("Add Repository"))),d.a.createElement("div",{className:"modal-body"},this.renderBody()),!t||"unknown"!==t.error_type||t.message?d.a.createElement("div",{className:"modal-footer"},d.a.createElement("button",{type:"button",className:"btn btn-default",onClick:this.onCancel,disabled:n===b.FormState.SAVING},Object(y.t)("Cancel")),d.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.onSubmit,disabled:n===b.FormState.SAVING},Object(y.t)("Save Changes"))):null)}},{key:"render",value:function(){var e=this.props.provider;return d.a.createElement(d.a.Fragment,null,d.a.createElement("a",{onClick:this.onOpen},e.name),this.renderModal())}}]),t}(v.a),l.propTypes={provider:f.a.object.isRequired},s);t.a=j}});
//# sourceMappingURL=36.js.map