webpackJsonpexports([29],{1604:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e,t){var n=void 0!=window.screenLeft?window.screenLeft:screen.left,r=void 0!=window.screenTop?window.screenTop:screen.top;return{left:(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-e/2+n,top:(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-t/2+r}}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"default",function(){return D});var l=n(620),u=n.n(l),s=n(14),d=n(0),f=n.n(d),p=n(10),g=n(2),m=n(1686),h=n(92),b=n(26),v=n(178),y=n(30),j=n(15),E=n(18),O=n(217),w=n(52),I=n(21),k=n(1731),P=n(1788),_=n(1789),x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},z=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),R=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in o)return o.value;var i=o.get;if(void 0!==i)return i.call(r)},T=new k.a.Renderer;T.paragraph=function(e){return e};var D=function(e){function t(){var e,n,r,i;o(this,t);for(var l=arguments.length,u=Array(l),s=0;s<l;s++)u[s]=arguments[s];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.handleAddIntegration=function(e){var t=e.setupDialog,n=t.url,o=t.width,a=t.height,i=c(o,a),l=i.left,u=i.top;r.dialog=window.open(n,"sentryAddIntegration","scrollbars=yes,width="+o+",height="+a+",top="+u+",left="+l),r.dialog.focus()},r.receiveMessage=function(e){if(e.origin===document.origin&&e.source===r.dialog){r.dialog=null;var t=e.data,n=t.success,o=t.data;if(!n)return void y.default.addError(Object(g.t)("Unable to add Integration"));r.mergeIntegration(o),y.default.addSuccess(Object(g.t)("Integration Added"))}},r.handleDeleteIntegration=function(e){var t=r.props.params.orgId,n=y.default.add(Object(g.t)("Removing Integration")),o={method:"DELETE",success:function(){r.setState({integrations:r.state.integrations.filter(function(t){return t.id!==e.id})}),y.default.addSuccess(Object(g.t)("Integration removed"))},error:function(){return y.default.addError(Object(g.t)("Failed to remove Integration"))},complete:function(){return y.default.remove(n)}};r.api.request("/organizations/"+t+"/integrations/"+e.id+"/",o)},r.handleRemoveProjectIntegration=function(e){var t=r.props.params,n=t.orgId,o=t.projectId,a=y.default.add(Object(g.t)("Disabling integration for project")),i={method:"DELETE",success:function(){delete e.configDataProjects[o],r.mergeIntegration(e),y.default.addSuccess(Object(g.t)("Integration disabled for project"))},error:function(){return y.default.addError(Object(g.t)("Failed to disable integration for project"))},complete:function(){return y.default.remove(a)}};r.api.request("/projects/"+n+"/"+o+"/integrations/"+e.id+"/",i)},r.handleEnableProjectIntegration=function(e){var t=r.props.params,n=t.orgId,o=t.projectId,a=y.default.add(Object(g.t)("Enabling integration for project")),i={method:"PUT",success:function(){e.configDataProjects[o]={},r.mergeIntegration(e),y.default.addSuccess(Object(g.t)("Integration enabled for project"))},error:function(){return y.default.addError(Object(g.t)("Failed to enable integration for project"))},complete:function(){return y.default.remove(a)}};r.api.request("/projects/"+n+"/"+o+"/integrations/"+e.id+"/",i)},r.handleToggleProjectIntegration=function(e,t){t?r.handleEnableProjectIntegration(e):r.handleRemoveProjectIntegration(e)},i=n,a(r,i)}return i(t,e),z(t,[{key:"componentDidMount",value:function(){this.dialog=null,window.addEventListener("message",this.receiveMessage,!1)}},{key:"componentWillUnmount",value:function(){R(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"componentWillUnmount",this).call(this),window.removeEventListener("message",this.receiveMessage),null!==this.dialog&&this.dialog.close()}},{key:"getProvider",value:function(){var e=this,t=this.state.config;return null!==t?t.providers.find(function(t){return t.key==e.props.params.providerKey})||null:null}},{key:"getTitle",value:function(){var e=this.getProvider();return null===e?"Global Integrations":e.name+" Integration"}},{key:"getEndpoints",value:function(){var e=this.props.params,t=e.orgId;return[["config","/organizations/"+t+"/config/integrations/"],["integrations","/organizations/"+t+"/integrations/?provider_key="+e.providerKey]]}},{key:"mergeIntegration",value:function(e){var t=u()(this.state.integrations,function(e){return e.id}),n=Object(p.q)(Object.values(x({},t,r({},e.id,e))),function(e){return e.name});this.setState({integrations:n})}},{key:"renderAlertLink",value:function(e){var t=e.metadata.aspects.alert_link;if(void 0!==t){var n=Object(k.a)(t.text,{renderer:T}),r=t.link;for(var o in this.props.params)r=r.replace("{"+o+"}",this.props.params[o]);var a=r.startsWith("http")?{href:r}:{to:r};return f.a.createElement(m.a,a,f.a.createElement("span",{dangerouslySetInnerHTML:{__html:n}}))}}},{key:"renderBody",value:function(){var e=this,t=this.state.integrations,n=this.getProvider();if(null===n)return f.a.createElement(j.default,{message:Object(g.t)("Invalid integration provider")});var r=f.a.createElement(O.a,{size:28,pluginId:n.key}),o=f.a.createElement(E.e,{disablePadding:!0,hasButtons:!0},f.a.createElement(s.Box,{px:2},n.metadata.noun),f.a.createElement(I.default,{disabled:n.canAdd,tooltipOptions:{placement:"left"},title:"Integration cannot be added on Sentry. Enable this integration via the "+n.name+" instance."},f.a.createElement(s.Box,{mr:1},f.a.createElement(b.default,{disabled:!n.canAdd,size:"xsmall",onClick:function(){return e.handleAddIntegration(n)}},f.a.createElement("span",{className:"icon icon-add"})," ",Object(g.t)("Add")+" "+n.metadata.noun)))),a=this.props.params,i=a.orgId,c=a.projectId,l=0===t.length?f.a.createElement(v.a,null,Object(g.t)("No %s integrations configured.",n.name)):t.map(function(t){return f.a.createElement(_.a,{key:t.id,orgId:i,projectId:c,provider:n,integration:t,onToggleEnabled:function(n){return e.handleToggleProjectIntegration(t,n)},onRemove:function(){return e.handleDeleteIntegration(t)}})});return f.a.createElement(f.a.Fragment,null,f.a.createElement(w.default,{title:n.name,icon:r}),f.a.createElement(E.a,null,o,f.a.createElement(E.c,null,l)),this.renderAlertLink(n),f.a.createElement("hr",null),f.a.createElement("h5",null,Object(g.t)("%s Integration",n.name)),f.a.createElement(P.a,{markdownDescription:n.metadata.description,author:n.metadata.author,links:[{href:n.metadata.issue_url,title:Object(g.t)("Report an Issue")},{href:n.metadata.source_url,title:Object(g.t)("View Source")}]}))}}]),t}(h.default)},1686:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}var o=n(5),a=n(1),i=n.n(a),c=n(0),l=n.n(c),u=n(53),s=n(24),d=n(38),f=Object(o.default)("div",{target:"e1fthm6j0"})("flex-grow:1;"),p=Object(o.default)(s.a,{target:"e1fthm6j1"})("margin-right:0.75em;"),g=Object(o.default)(function(e){var t=e.children,n=e.icon,o=r(e,["children","icon"]);return l.a.createElement(u.a,o,n&&l.a.createElement(p,{src:n,size:"1.5em"}),l.a.createElement(f,null,t),l.a.createElement(s.a,{src:"icon-chevron-right",size:"1em"}))},{target:"e1fthm6j2"})("display:flex;align-items:center;background-color:",function(e){return e.theme.yellowLightest},";color:",function(e){return e.theme.gray5},";border:1px dashed ",function(e){return e.theme.borderDark},";padding:",Object(d.a)(2),";margin-bottom:",Object(d.a)(3),";border-radius:0.25em;transition:0.2s border-color;&:hover{border-color:",function(e){return e.theme.blueLight},";}");g.propTypes={to:i.a.string,href:i.a.string,icon:i.a.string},t.a=g},1731:function(e,t,n){"use strict";function r(e,t){try{return t.test(decodeURIComponent(unescape(e)))}catch(e){return!1}}function o(){return i.a.Renderer.apply(this,arguments)}var a=n(396),i=n.n(a);Object.assign(o.prototype,i.a.Renderer.prototype);var c=/^(https?:|mailto:)/i;o.prototype.link=function(e,t,n){if(this.options.sanitize&&!r(e,c))return e;var o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+n+"</a>"};var l=/^https?:\/\/./i;o.prototype.image=function(e,t,n){if(this.options.sanitize&&!r(e,l))return"";var o='<img src="'+e+'" alt="'+n+'"';return t&&(o+=' title="'+t+'"'),o+=this.options.xhtml?"/>":">"},i.a.setOptions({renderer:new o,sanitize:!0}),t.a=i.a},1788:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return O});var i,c,l=n(14),u=n(1),s=n.n(u),d=n(0),f=n.n(d),p=n(396),g=n.n(p),m=n(5),h=n(2),b=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),v=Object(m.default)(l.Flex,{target:"e58h7zp0"})("font-size:1.5rem;line-height:2.1rem;"),y=Object(m.default)("div",{target:"e58h7zp1"})("li{margin-bottom:6px;}"),j=Object(m.default)("div",{target:"e58h7zp2"})("color:",function(e){return e.theme.gray2},";"),E=Object(m.default)("a",{target:"e58h7zp3"})("display:block;margin-bottom:6px;"),O=(c=i=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),b(t,[{key:"render",value:function(){var e=g()(this.props.markdownDescription);return f.a.createElement(v,null,f.a.createElement(l.Box,{width:5/8},f.a.createElement(y,{dangerouslySetInnerHTML:{__html:e}}),f.a.createElement(j,null,Object(h.t)("By %s",this.props.author))),f.a.createElement(l.Box,{ml:60},this.props.links.map(function(e){var t=e.href,n=e.title;return f.a.createElement(E,{key:t,href:t},n)})))}}]),t}(f.a.Component),i.propTypes={markdownDescription:s.a.string.isRequired,author:s.a.string.isRequired,links:s.a.arrayOf(s.a.shape({href:s.a.string.isRequired,title:s.a.string.isRequired}))},c)},1789:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return x});var i,c,l=n(14),u=n(1),s=n.n(u),d=n(0),f=n.n(d),p=n(5),g=n(18),m=n(2),h=n(26),b=n(119),v=n(214),y=n(21),j=n(601),E=n(600),O=n(217),w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},I=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),k=Object(p.default)("img",{target:"e13u596k0"})("height:32px;width:32px;border-radius:2px;display:block;"),P=Object(p.default)("div",{target:"e13u596k1"})("font-size:1.6rem;margin-bottom:3px;"),_=Object(p.default)("div",{target:"e13u596k2"})("color:",function(e){return e.theme.gray3},";font-size:1.4rem;"),x=(c=i=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.onConfigure=function(){return e.setState({configuring:!e.state.configuring})},e.state={configuring:!1},e}return a(t,e),I(t,[{key:"renderConfiguration",value:function(){var e=this.props,t=e.integration,n=e.orgId,r=e.projectId,o=t.configProject,a=t.configOrganization,i={hideFooter:!0,saveOnBlur:!0,allowUndo:!0,apiMethod:"POST",dataTransformer:function(e){return{config:e}}};return f.a.createElement(f.a.Fragment,null,o.length>0&&f.a.createElement(E.a,w({},i,{initialData:t.configDataProjects[r],apiEndpoint:"/projects/"+n+"/"+r+"/integrations/"+t.id+"/"}),o.map(function(e){return f.a.createElement(j.a,{key:e.name,field:e})})),a.length>0&&f.a.createElement(f.a.Fragment,null,f.a.createElement(g.b,{type:"info"},Object(m.t)("The following configurations are organization-scoped. Changing these will change the settings globally.")),f.a.createElement(E.a,w({},i,{initialData:t.configData,apiEndpoint:"/organizations/"+this.props.orgId+"/integrations/"+t.id+"/"}),a.map(function(e){return f.a.createElement(j.a,{key:e.name,field:e})}))))}},{key:"isEnabledForProject",value:function(){return void 0!==this.props.integration.configDataProjects[this.props.projectId]}},{key:"hasConfiguration",value:function(){return this.props.integration.configProject.length>0||this.props.integration.configOrganization.length>0}},{key:"render",value:function(){var e=this,t=this.props,n=t.integration,r=t.provider,o=this.isEnabledForProject();return f.a.createElement(f.a.Fragment,null,f.a.createElement(g.f,{p:0,py:2,key:n.id,align:"center"},f.a.createElement(l.Box,{pl:2},n.icon?f.a.createElement(k,{src:n.icon}):f.a.createElement(O.a,{size:32,pluginId:r.key})),f.a.createElement(l.Box,{px:2,flex:1},f.a.createElement(P,null,n.name),f.a.createElement(_,null,n.domainName)),r.canAddProject&&f.a.createElement(l.Flex,{mr:1},f.a.createElement(y.default,{title:Object(m.t)("Enable for this Project")},f.a.createElement(v.default,{size:"lg",isActive:o,toggle:function(){return e.props.onToggleEnabled(!o)}}))),this.hasConfiguration()&&f.a.createElement(l.Box,{mr:1},f.a.createElement(h.default,{size:"small",disabled:!this.isEnabledForProject()&&r.canAddProject,priority:this.state.configuring?"primary":void 0,onClick:this.onConfigure},"Configure")),f.a.createElement(l.Box,{mr:1,pr:2},f.a.createElement(b.a,{message:Object(m.t)("Removing this inegration will disable the integration for all projects. Are you sure you want to remove this integration?"),onConfirm:function(){return e.props.onRemove()}},f.a.createElement(h.default,{size:"small"},f.a.createElement("span",{className:"icon icon-trash",style:{margin:0}}))))),f.a.createElement("div",{style:{display:!this.state.configuring||!this.isEnabledForProject()&&r.canAddProject?"none":"block"}},this.renderConfiguration()))}}]),t}(f.a.Component),i.propTypes={orgId:s.a.string.isRequired,projectId:s.a.string.isRequired,provider:s.a.object.isRequired,integration:s.a.object.isRequired,onRemove:s.a.func.isRequired,onToggleEnabled:s.a.func.isRequired},c)}});
//# sourceMappingURL=OrganizationIntegration.js.map