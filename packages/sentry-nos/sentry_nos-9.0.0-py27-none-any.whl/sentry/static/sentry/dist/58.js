webpackJsonpexports([58],{1629:function(e,t,n){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"default",function(){return m});var s=n(0),l=n.n(s),u=n(92),c=n(1711),h=n(55),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},d=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),p=function e(t,n,a){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,a)}if("value"in r)return r.value;var o=r.get;if(void 0!==o)return o.call(a)},m=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),d(t,[{key:"getDefaultState",value:function(){return f({},p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getDefaultState",this).call(this),{timeWindow:"1w",since:(new Date).getTime()/1e3-604800,resolution:"1h",taskName:null})}},{key:"getEndpoints",value:function(){return[["taskList","/internal/queue/tasks/"]]}},{key:"changeWindow",value:function(e){var t=void 0;if("1h"===e)t=3600;else if("1d"===e)t=86400;else{if("1w"!==e)throw new Error("Invalid time window");t=604800}this.setState({since:(new Date).getTime()/1e3-t,timeWindow:e})}},{key:"changeTask",value:function(e){this.setState({activeTask:e})}},{key:"renderBody",value:function(){var e,t=this,n=this.state,r=n.activeTask,i=n.taskList;return l.a.createElement("div",null,l.a.createElement("div",{className:"btn-group pull-right"},["1h","1d","1w"].map(function(e){return l.a.createElement("a",{className:"btn btn-sm "+(e==t.state.timeWindow?"btn-primary":"btn-default"),onClick:function(){return t.changeWindow(e)},key:e},e)})),l.a.createElement("h3",{className:"no-border"},"Queue Overview"),l.a.createElement("div",{className:"box"},l.a.createElement("div",{className:"box-header"},l.a.createElement("h3",null,"Global Throughput")),l.a.createElement(c.a,{since:this.state.since,resolution:this.state.resolution,stat:"jobs.all.started",label:"jobs started"})),l.a.createElement("h3",{className:"no-border"},"Task Details"),l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement("label",null,"Show details for task:"),l.a.createElement(h.Select2Field,{name:"task",onChange:this.changeTask,value:r,allowClear:!0,choices:(e=[""]).concat.apply(e,a(i)).map(function(e){return[e,e]})})),r?l.a.createElement("div",null,l.a.createElement("div",{className:"box box-mini",key:"jobs.started"},l.a.createElement("div",{className:"box-header"},"Jobs Started ",l.a.createElement("small",null,r)),l.a.createElement(c.a,{since:this.state.since,resolution:this.state.resolution,stat:"jobs.started."+this.state.activeTask,label:"jobs",height:100})),l.a.createElement("div",{className:"box box-mini",key:"jobs.finished"},l.a.createElement("div",{className:"box-header"},"Jobs Finished ",l.a.createElement("small",null,r)),l.a.createElement(c.a,{since:this.state.since,resolution:this.state.resolution,stat:"jobs.finished."+this.state.activeTask,label:"jobs",height:100}))):null))}}]),t}(u.default)},1711:function(e,t,n){"use strict";var a=n(28),r=n.n(a),i=n(1),o=n.n(i),s=n(0),l=n.n(s),u=n(3),c=n.n(u),h=n(8),f=n(215),d=n(15),p=n(11),m=function(){function e(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.a=c()({displayName:"internalStatChart",propTypes:{since:o.a.number.isRequired,resolution:o.a.string.isRequired,stat:o.a.string.isRequired,label:o.a.string,height:o.a.number},mixins:[h.default],getDefaultProps:function(){return{height:150}},getInitialState:function(){return{error:!1,loading:!0,data:null}},componentWillMount:function(){this.fetchData()},componentWillReceiveProps:function(e){r()(e,this.props)||this.setState({loading:!0},this.fetchData)},shouldComponentUpdate:function(e,t){return this.state.loading!==t.loading},fetchData:function(){var e=this;this.api.request("/internal/stats/",{method:"GET",data:{since:this.props.since,resolution:this.props.resolution,key:this.props.stat},success:function(t){e.setState({data:t,loading:!1,error:!1})},error:function(t){e.setState({error:!0})}})},getChartPoints:function(){return this.state.data.map(function(e){var t=m(e,2);return{x:t[0],y:t[1]}})},render:function(){return this.state.loading?l.a.createElement(p.default,null):this.state.error?l.a.createElement(d.default,{onRetry:this.fetchData}):l.a.createElement(f.default,{points:this.getChartPoints(),className:"standard-barchart",label:this.props.label,height:this.props.height})}})}});
//# sourceMappingURL=AdminQueue.js.map