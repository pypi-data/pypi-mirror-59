import os
from memcnn.utils.tensorboard import parse_logs
import codecs


content = u'090000000000000037f97139092616d5' \
            '3a7d34d741ac5881be18000000000000' \
            '00a37f4b2209b41ad73a7d34d7411001' \
            '2a0b0a090a026c721517b7d1384c5021' \
            'f02100000000000000017becf609daa8' \
            '8b3c7d34d74110012a140a120a0b7472' \
            '61696e5f775f6d696e15b4d2b9bf17db' \
            'c2ea2100000000000000017becf609b2' \
            'ab8b3c7d34d74110012a140a120a0b74' \
            '7261696e5f775f61766715d987453dff' \
            '23d1cb2100000000000000017becf609' \
            'beac8b3c7d34d74110012a140a120a0b' \
            '747261696e5f775f6d6178155463f73f' \
            '4ab386582100000000000000017becf6' \
            '0994ad8b3c7d34d74110012a140a120a' \
            '0b747261696e5f675f6d696e15cf04f1' \
            'bc1b868ff82100000000000000017bec' \
            'f60962ae8b3c7d34d74110012a140a12' \
            '0a0b747261696e5f675f617667156ee9' \
            '1cbb73c171532100000000000000017b' \
            'ecf60966af8b3c7d34d74110012a140a' \
            '120a0b747261696e5f675f6d617815b2' \
            '23f13cf3bfc110200000000000000029' \
            'eda950094142a13c7d34d74110012a13' \
            '0a110a0a747261696e5f6c6f73731550' \
            'f3a03aee7305641800000000000000a3' \
            '7f4b22095a44a13c7d34d74110012a0b' \
            '0a090a026c721517b7d1382bfee06d18' \
            '00000000000000a37f4b22096645a13c' \
            '7d34d74110012a0b0a090a026c721517' \
            'b7d138ccbfc466210000000000000001' \
            '7becf6095c41033e7d34d74110022a14' \
            '0a120a0b747261696e5f775f6d696e15' \
            '7dc9b9bf60787a932100000000000000' \
            '017becf609bf44033e7d34d74110022a' \
            '140a120a0b747261696e5f775f617667' \
            '157da8453dcff9a86f21000000000000' \
            '00017becf609c745033e7d34d7411002' \
            '2a140a120a0b747261696e5f775f6d61' \
            '7815675af73fc460b3e0210000000000' \
            '0000017becf609aa46033e7d34d74110' \
            '022a140a120a0b747261696e5f675f6d' \
            '696e15e63b82bd1af5f9e52100000000' \
            '000000017becf6098347033e7d34d741' \
            '10022a140a120a0b747261696e5f675f' \
            '61766715e999a9bb4624aac321000000' \
            '00000000017becf6095648033e7d34d7' \
            '4110022a140a120a0b747261696e5f67' \
            '5f6d617815539b823dad22b9e6200000' \
            '000000000029eda95009b6d6173e7d34' \
            'd74110022a130a110a0a747261696e5f' \
            '6c6f73731571582c3b32a37473180000' \
            '0000000000a37f4b22099ed8173e7d34' \
            'd74110022a0b0a090a026c721517b7d1' \
            '388adfd3a41800000000000000a37f4b' \
            '2209a2d9173e7d34d74110022a0b0a09' \
            '0a026c721517b7d138ed1dd2af210000' \
            '0000000000017becf609ba4a713f7d34' \
            'd74110032a140a120a0b747261696e5f' \
            '775f6d696e15d6c0b9bf41e8e84a2100' \
            '000000000000017becf609964d713f7d' \
            '34d74110032a140a120a0b747261696e' \
            '5f775f6176671514b1453d8f6e574121' \
            '00000000000000017becf609934e713f' \
            '7d34d74110032a140a120a0b74726169' \
            '6e5f775f6d6178156a52f73faaa02db7' \
            '2100000000000000017becf609704f71' \
            '3f7d34d74110032a140a120a0b747261' \
            '696e5f675f6d696e15c7a5fdbca31673' \
            'ba2100000000000000017becf6094550' \
            '713f7d34d74110032a140a120a0b7472' \
            '61696e5f675f617667151faf25bbb48e' \
            '9b4a2100000000000000017becf60949' \
            '51713f7d34d74110032a140a120a0b74' \
            '7261696e5f675f6d61781573c1fd3c74' \
            '66c56a200000000000000029eda95009' \
            '0ae5853f7d34d74110032a130a110a0a' \
            '747261696e5f6c6f7373152ea2233b6c' \
            'e2aa921800000000000000a37f4b2209' \
            'b9e6853f7d34d74110032a0b0a090a02' \
            '6c721517b7d138809d5e4a1800000000' \
            '000000a37f4b2209b7e7853f7d34d741' \
            '10032a0b0a090a026c721517b7d138b5' \
            '2459862100000000000000017becf609' \
            'c5f913417d34d74110042a140a120a0b' \
            '747261696e5f775f6d696e15babcb9bf' \
            '41e964742100000000000000017becf6' \
            '09bafc13417d34d74110042a140a120a' \
            '0b747261696e5f775f6176671555c045' \
            '3d53db2c8d2100000000000000017bec' \
            'f609bafd13417d34d74110042a140a12' \
            '0a0b747261696e5f775f6d617815c04e' \
            'f73f84786f952100000000000000017b' \
            'ecf60999fe13417d34d74110042a140a' \
            '120a0b747261696e5f675f6d696e1562' \
            '5990bdacbe2c1c210000000000000001' \
            '7becf6096dff13417d34d74110042a14' \
            '0a120a0b747261696e5f675f61766715' \
            '54d7bbbb5554aa172100000000000000' \
            '017becf6093d0014417d34d74110042a' \
            '140a120a0b747261696e5f675f6d6178' \
            '15cde4913d146ec81e20000000000000' \
            '0029eda95009378e2a417d34d7411004' \
            '2a130a110a0a747261696e5f6c6f7373' \
            '151850a03bde074fbc18000000000000' \
            '00a37f4b220935902a417d34d7411004' \
            '2a0b0a090a026c721517b7d1388c808e' \
            '231800000000000000a37f4b22093291' \
            '2a417d34d74110042a0b0a090a026c72' \
            '1517b7d138089f54b3'


def test_parse_logs(tmp_path):
    dir_path = str(tmp_path / "testdir")
    os.makedirs(dir_path)
    output_file = str(tmp_path / "outfiletest.json")
    event_file = os.path.join(dir_path, 'events.out.tfevents.1557243322.5875ed5eada9')
    dec = codecs.getdecoder('hex')
    with open(event_file, 'wb') as fh:
        fh.write(dec(content)[0])

    # on empty do nothing
    parse_logs(dir_path, output_file)
