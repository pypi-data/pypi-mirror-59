<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.15.2: http://docutils.sourceforge.net/" />
<title>panwfapi.py</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="panwfapi-py">
<h1 class="title">panwfapi.py</h1>
<h2 class="subtitle" id="command-line-program-for-accessing-the-wildfire-api">command line program for accessing the WildFire API</h2>

<!-- Copyright (c) 2013-2017 Kevin Steves <kevin.steves@pobox.com>

Permission to use, copy, modify, and distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. -->
<div class="section" id="name">
<h1>NAME</h1>
<blockquote>
panwfapi.py - command line program for accessing the WildFire API</blockquote>
</div>
<div class="section" id="synopsis">
<h1>SYNOPSIS</h1>
<pre class="literal-block">
panwfapi.py [options]
   --submit path|url     submit file or URL to WildFire for analysis
   --submit-link link    submit links to WildFire for analysis
   --change-request      request review of sample's verdict
   --report              get WildFire report
   --verdict             get WildFire sample verdict
   --sample              get WildFire sample file
   --pcap                get WildFire PCAP files
   --changed             get changed verdicts
   --hash hash           query MD5 or SHA256 hash
   --platform id         platform ID for sandbox environment
   --new-verdict verdict benign|malware|grayware|phishing
   --email address       notification e-mail address
   --comment comment     change request explanation
   --testfile            get sample malware test file
   --type type           test file type
   --format format       report output format
   --date date           start date for changed verdicts
                         (YYYY-MM-DD or -days)
   --dst dst             save file to directory or path
   -K api_key            WildFire API key
   -h hostname           WildFire hostname
   -x                    print XML response to stdout
   -p                    print XML response in Python to stdout
   -j                    print XML response in JSON to stdout
   -D                    enable debug (multiple up to -DDD)
   -t tag                .panrc tagname
   -T seconds            urlopen() timeout
   --http                use http URL scheme (default https)
   --ssl opt             SSL verify option: default|noverify
   --cafile path         file containing CA certificates
   --capath path         directory of hashed certificate files
   --version             display version
   --help                display usage
</pre>
</div>
<div class="section" id="description">
<h1>DESCRIPTION</h1>
<blockquote>
<p><strong>panwfapi.py</strong> is used to perform API requests on the WildFire
cloud.  It uses the PanWFapi class from the <strong>pan.wfapi</strong> module to
execute API requests.</p>
<p>The options are:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">--submit</span></tt> <em>path|url</em></dt>
<dd>Submit a file or URL to WildFire for analysis.  Valid URL
schemes for <em>url</em> are: <strong>file</strong>, <strong>http</strong>, <strong>https</strong> and <strong>ftp</strong>.
A <strong>file</strong> <em>url</em> is the same as specifying <em>path</em>.</dd>
<dt><tt class="docutils literal"><span class="pre">--submit-link</span></tt> <em>link</em></dt>
<dd><p class="first">Submit links to WildFire for analysis.  A link is a URL to a
web page.</p>
<p><em>link</em> can be a single link or a path to a file containing multiple
newline delimited links or <strong>-</strong> to specify that links be read from
<em>stdin</em>.</p>
<p class="last">A maximum of 1,000 links can be submitted in a request.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">--change-request</span></tt></dt>
<dd>Request  a manual review
of a sample's verdict by the Threat Research Team.  Requires
<strong>--hash</strong>, <strong>--new-verdict</strong>, <strong>--email</strong> and <strong>--comment</strong> arguments.</dd>
<dt><tt class="docutils literal"><span class="pre">--report</span></tt></dt>
<dd>Get analysis report for a previously uploaded sample.  The
sample can be specified by its MD5 or SHA256 hash (<strong>--hash</strong>).</dd>
<dt><tt class="docutils literal"><span class="pre">--verdict</span></tt></dt>
<dd>Get the verdict(s) for previously uploaded samples.  The samples can
be specified by their MD5 or SHA256 hash (<strong>--hash</strong>).  Up to 500
hashes can be specified.</dd>
<dt><tt class="docutils literal"><span class="pre">--sample</span></tt></dt>
<dd>Get a previously uploaded sample file.  The sample can be specified
by its MD5 or SHA256 hash (<strong>--hash</strong>).</dd>
<dt><tt class="docutils literal"><span class="pre">--pcap</span></tt></dt>
<dd>Get PCAP (packet capture) file of network activity for a previously
uploaded sample.  The sample can be specified by its MD5 or SHA256
hash (<strong>--hash</strong>).  The sandbox environment for the PCAP can optionally
be specified using the platform ID (<strong>--platform</strong>).  If no platform
is specified a PCAP from an environment that resulted in a <em>Malware</em>
verdict is returned.</dd>
<dt><tt class="docutils literal"><span class="pre">--changed</span></tt></dt>
<dd>Get the hashes of samples whose verdicts have changed within the
last 30 days starting at the date specified with <strong>--date</strong>.</dd>
<dt><tt class="docutils literal"><span class="pre">--hash</span></tt> <em>hash</em></dt>
<dd>MD5 or SHA256 hash for a WildFire sample.  <strong>--hash</strong> can be
specified multiple times for queries which allow multiple hashes.
It can also be a path to a file containing the hashes or <strong>'-'</strong> to
specify that hashes be read from <em>stdin</em>.</dd>
<dt><tt class="docutils literal"><span class="pre">--platform</span></tt> <em>id</em></dt>
<dd>Platform ID for sandbox environment.
Platform IDs are documented in the
<a class="reference external" href="https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-api/get-wildfire-information-through-the-wildfire-api/get-a-packet-capture-wildfire-api.html">Get a Packet Capture</a>
section of the <em>WildFire API Reference</em>.</dd>
<dt><tt class="docutils literal"><span class="pre">--testfile</span></tt></dt>
<dd><p class="first">Get sample malware test file.    Each
request returns a similar file named
<tt class="docutils literal"><span class="pre">wildfire-test-</span></tt><em>file_type</em><tt class="docutils literal"><span class="pre">-file</span></tt> with a different hash
and with verdict <em>Malware</em>.</p>
<p class="last">This requires an <tt class="docutils literal">api_key</tt> even though it is not
needed for the API request.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">--type</span></tt> <em>type</em></dt>
<dd><p class="first">Specify the file type for <strong>--testfile</strong>.</p>
<p><em>type</em> is one of the following file types:</p>
<blockquote class="last">
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="22%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">File Type</th>
<th class="head">File Suffix</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>pe</td>
<td>.exe</td>
<td>Portable Executable format</td>
</tr>
<tr><td>apk</td>
<td>.apk</td>
<td>Android Package</td>
</tr>
<tr><td>macos</td>
<td>none</td>
<td>MacOSX</td>
</tr>
<tr><td>elf</td>
<td>none</td>
<td>Executable and Linkable Format</td>
</tr>
</tbody>
</table>
<p>The default is <strong>pe</strong>.</p>
</blockquote>
</dd>
<dt><tt class="docutils literal"><span class="pre">--format</span></tt> <em>format</em></dt>
<dd><p class="first">WildFire report output format string.  This can be <strong>xml</strong> or <strong>pdf</strong>.</p>
<p class="last">The default is <strong>xml</strong>.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">--date</span></tt> <em>date</em></dt>
<dd>Start date for <strong>--changed</strong> query.  The format for the
<em>date</em> argument is <em>YYYY-MM-DD</em> or <em>-days</em> to specify a date
relative to the current day.  <em>0</em> can be also be used to specify
the current date.</dd>
<dt><tt class="docutils literal"><span class="pre">--dst</span></tt> <em>dst</em></dt>
<dd><p class="first">Save file to the directory or path specified in <em>dst</em>.  By default
files are saved with the filename specified in the HTTP response
attachment.  Files saved are:</p>
<ul class="last">
<li><p class="first">WildFire samples (<strong>--sample</strong>)</p>
<p>sha256-hash-of-sample</p>
</li>
<li><p class="first">PDF files (<strong>--format=pdf</strong>)</p>
<p>sha256-hash-of-sample.pdf</p>
</li>
<li><p class="first">PCAP files (<strong>--pcap</strong>)</p>
<p>sha256-hash-of-sample.platform.unknown.pcap</p>
</li>
<li><p class="first">Malware test file (<strong>--testfile</strong>)</p>
<p>wildfire-test-<em>file_type</em>-file</p>
</li>
</ul>
</dd>
<dt><tt class="docutils literal"><span class="pre">--new-verdict</span></tt> <em>verdict</em></dt>
<dd>The suggested verdict.  Can be specified as a string (<em>benign</em>,
<em>malware</em>, <em>grayware</em>, <em>phishing</em>) or an integer.</dd>
<dt><tt class="docutils literal"><span class="pre">--email</span></tt> <em>address</em></dt>
<dd>Notification e-mail address.</dd>
<dt><tt class="docutils literal"><span class="pre">--comment</span></tt> <em>comment</em></dt>
<dd>Explanation for the change request.  Can be up to 2048 bytes.
<em>comment</em> can be a string, a path to a file containing the comment or
<strong>'-'</strong> to specify the comment be read from <em>stdin</em>.</dd>
<dt><tt class="docutils literal"><span class="pre">-K</span></tt> <em>api_key</em></dt>
<dd>Specify the <strong>api_key</strong> used in API requests.  This can also be
specified in a .panrc file using the <tt class="docutils literal">api_key</tt> <em>varname</em>.</dd>
<dt><tt class="docutils literal"><span class="pre">-h</span></tt> <em>hostname</em></dt>
<dd><p class="first">Specify the <strong>hostname</strong> used in API requests.  This can also be
specified in a .panrc file using the <tt class="docutils literal">hostname</tt> <em>varname</em>.</p>
<p>This is used to specify an alternate cloud (e.g.,
<tt class="docutils literal">beta.wildfire.paloaltonetworks.com</tt>) or a WildFire appliance.</p>
<p class="last">The default is <tt class="docutils literal">wildfire.paloaltonetworks.com</tt>.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">-x</span></tt></dt>
<dd>Print XML response to <em>stdout</em>.</dd>
<dt><tt class="docutils literal"><span class="pre">-p</span></tt></dt>
<dd>Print XML response in Python to <em>stdout</em>.</dd>
<dt><tt class="docutils literal"><span class="pre">-j</span></tt></dt>
<dd>Print XML response in JSON to <em>stdout</em>.</dd>
<dt><tt class="docutils literal"><span class="pre">-D</span></tt></dt>
<dd>Enable debugging.  May be specified multiple times up to 3
to increase debugging output.</dd>
<dt><tt class="docutils literal"><span class="pre">-t</span></tt> <em>tag</em></dt>
<dd>Specify tagname for .panrc.</dd>
<dt><tt class="docutils literal"><span class="pre">-T</span></tt> <em>seconds</em></dt>
<dd>Specify the <tt class="docutils literal">timeout</tt> value for urlopen().</dd>
<dt><tt class="docutils literal"><span class="pre">--http</span></tt></dt>
<dd>Use <em>http</em> URL scheme for API requests.  This can be used with the
<tt class="docutils literal"><span class="pre">--testfile</span></tt> option to get a malware test file over HTTP.</dd>
<dt><tt class="docutils literal"><span class="pre">--ssl</span></tt> <em>opt</em></dt>
<dd><p class="first">Specify the type of SSL server certificate verification to be
performed.</p>
<dl class="docutils">
<dt><tt class="docutils literal">noverify</tt></dt>
<dd>Disable SSL server certificate verification.</dd>
<dt><tt class="docutils literal">default</tt></dt>
<dd><p class="first">If the <strong>certifi</strong> package is installed its Certificate Authority
(CA) bundle is used for SSL server certificate verification,
otherwise no changes are made to the default <strong>ssl</strong> module
settings.</p>
<p class="last">This is the default.</p>
</dd>
</dl>
<p>SSL server certificate verification is only performed in Python
version 2.7.9 and 3.4.3 and greater.</p>
<p class="last"><tt class="docutils literal"><span class="pre">--ssl</span></tt> is ignored if <tt class="docutils literal"><span class="pre">--cafile</span></tt> or <tt class="docutils literal"><span class="pre">--capath</span></tt> are specified.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">--cafile</span></tt> <em>path</em></dt>
<dd>A file containing CA certificates to be used for SSL
server certificate verification.</dd>
<dt><tt class="docutils literal"><span class="pre">--capath</span></tt> <em>path</em></dt>
<dd>A directory of hashed certificate files to be used for
SSL server certificate verification.</dd>
<dt><tt class="docutils literal"><span class="pre">--version</span></tt></dt>
<dd>Display version.</dd>
<dt><tt class="docutils literal"><span class="pre">--help</span></tt></dt>
<dd>Display command options.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="files">
<h1>FILES</h1>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal">.panrc</tt></dt>
<dd>.panrc file.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="exit-status">
<h1>EXIT STATUS</h1>
<blockquote>
<strong>panwfapi.py</strong> exits with 0 on success and 1 if an error occurs.</blockquote>
</div>
<div class="section" id="examples">
<h1>EXAMPLES</h1>
<blockquote>
<p>Add WildFire API key to .panrc file.</p>
<pre class="literal-block">
$ echo 'api_key%wildfire=d3b07384d113edec49eaa6238ad5ff00' &gt;&gt;.panrc
</pre>
<p>Submit file to WildFire for analysis and print XML response.</p>
<pre class="literal-block">
$ panwfapi.py -t wildfire -x --submit /tmp/sample.exe
submit: 200 OK [response_body=True response_type=xml]

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;&lt;wildfire&gt;&lt;upload-file-info&gt;&lt;url&gt;&lt;/url&gt;&lt;filename&gt;sample.exe&lt;/filename&gt;&lt;sha256&gt;5a036546422c5235283254234fc5a67a36e3221a2324a3087db0081f08cc38e6&lt;/sha256&gt;&lt;md5&gt;ada8501b1e2abae90a83cc4cf20196d8&lt;/md5&gt;&lt;size&gt;466356&lt;/size&gt;&lt;filetype&gt;PE32 executable&lt;/filetype&gt;&lt;/upload-file-info&gt;&lt;/wildfire&gt;
</pre>
<p>Query WildFire sample report by MD5 hash and print XML response.</p>
<pre class="literal-block">
$ panwfapi.py -t wildfire -x --report --hash 6de476723a12ad277a84f031868aace3 | head
report: 200 OK [response_body=True response_type=xml]
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;wildfire&gt;
&lt;version&gt;2.0&lt;/version&gt;
&lt;file_info&gt;
    &lt;sha256&gt;74e330f15ac544a7e5201b9bed97d4425058a47bd10a6763932181f78b99116e&lt;/sha256&gt;
    &lt;md5&gt;6de476723a12ad277a84f031868aace3&lt;/md5&gt;
    &lt;filetype&gt;PE&lt;/filetype&gt;
    &lt;size&gt;313856&lt;/size&gt;
    &lt;malware&gt;yes&lt;/malware&gt;
&lt;/file_info&gt;
</pre>
<p>Get previously uploaded sample.</p>
<pre class="literal-block">
$ panwfapi.py -t wildfire --sample --hash 6de476723a12ad277a84f031868aace3 --dst /tmp
sample: 200 OK [attachment=&quot;74e330f15ac544a7e5201b9bed97d4425058a47bd10a6763932181f78b99116e&quot;]
saved /tmp/74e330f15ac544a7e5201b9bed97d4425058a47bd10a6763932181f78b99116e
</pre>
<p>Get PCAP file of sample network activity.</p>
<pre class="literal-block">
$ panwfapi.py -t wildfire --pcap --hash 11727b1d9ed03799a756d1bbb84e6319 --platform 4
pcap: 200 OK [attachment=&quot;033e2d2ea39ffd9285d75edff1171c4b9f28fb407a314010f87f5d7ed98517d6.4.1.pcap&quot;]
saved 033e2d2ea39ffd9285d75edff1171c4b9f28fb407a314010f87f5d7ed98517d6.4.1.pcap
</pre>
<p>Submit URL to WildFire for analysis and print XML response in JSON.</p>
<pre class="literal-block">
$ panwfapi.py -t wildfire -j --submit \
&gt; https://www.paloaltonetworks.com/content/dam/paloaltonetworks-com/en_US/assets/pdf/datasheets/wildfire/wildfire.pdf
submit: 200 OK [response_body=True response_type=xml]
{
  &quot;wildfire&quot;: {
    &quot;upload-file-info&quot;: {
      &quot;filename&quot;: null,
      &quot;filetype&quot;: &quot;Adobe PDF document&quot;,
      &quot;md5&quot;: &quot;b81a9805d672bc6d574bd76ffd09ad54&quot;,
      &quot;sha256&quot;: &quot;716bc87686b4242c4e446fdb4599cf112fdd6fd85600a30a1856a67cc61b9c25&quot;,
      &quot;size&quot;: &quot;1236454&quot;,
      &quot;url&quot;: &quot;https://www.paloaltonetworks.com/content/dam/paloaltonetworks-com/en_US/assets/pdf/datasheets/wildfire/wildfire.pdf&quot;
    }
  }
}
</pre>
<p>Get malware test file over HTTP.</p>
<pre class="literal-block">
$ panwfapi.py --testfile --http -K 0
testfile: 200 OK [attachment=&quot;wildfire-test-pe-file.exe&quot;]
saved wildfire-test-pe-file.exe
</pre>
</blockquote>
</div>
<div class="section" id="see-also">
<h1>SEE ALSO</h1>
<blockquote>
<p>pan.wfapi</p>
<dl class="docutils">
<dt>WildFire Administrator's Guide</dt>
<dd><a class="reference external" href="https://docs.paloaltonetworks.com/wildfire/9-1/wildfire-admin.html">https://docs.paloaltonetworks.com/wildfire/9-1/wildfire-admin.html</a></dd>
<dt>WildFire API Reference</dt>
<dd><a class="reference external" href="https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-api.html">https://docs.paloaltonetworks.com/wildfire/9-0/wildfire-api.html</a></dd>
</dl>
</blockquote>
</div>
<div class="section" id="authors">
<h1>AUTHORS</h1>
<blockquote>
Kevin Steves &lt;<a class="reference external" href="mailto:kevin.steves&#64;pobox.com">kevin.steves&#64;pobox.com</a>&gt;</blockquote>
</div>
</div>
</body>
</html>
