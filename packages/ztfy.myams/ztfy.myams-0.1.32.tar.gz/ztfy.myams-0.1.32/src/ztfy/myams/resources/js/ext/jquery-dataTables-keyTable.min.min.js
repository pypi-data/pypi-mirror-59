var KeyTable;!function(e,t,n){!function(n,o){KeyTable=function(o){function l(e,t,n,o){E[e].push({x:t,y:n,fn:o})}function a(e,t,n,o){for(var l=0,a=0,i=E[e].length;a<i-l;a++)if(void 0!==o)E[e][a-l].x==t&&E[e][a-l].y==n&&E[e][a-l].fn==o&&(E[e].splice(a-l,1),l++);else if(E[e][a-l].x==t&&E[e][a-l].y==n)return E[e].splice(a,1),1;return l}function i(e,t,n){for(var o=0,l=E[e],a=0;a<l.length;a++)(l[a].x==t&&l[a].y==n||null===l[a].x&&l[a].y==n||l[a].x==t&&null===l[a].y||null===l[a].x&&null===l[a].y)&&(l[a].fn(y(t,n),t,n),o++);return o}function r(o,l){if(S!=o){void 0===l&&(l=!0),null!==S&&s(S),n(o).addClass(_),n(o).parent().addClass(_);var a;if(K){a=K;for(var r=m(o)[1],f=C;r>=a.fnDisplayEnd();)a._iDisplayLength>=0?a._iDisplayStart+a._iDisplayLength<a.fnRecordsDisplay()&&(a._iDisplayStart+=a._iDisplayLength):a._iDisplayStart=0,K.oApi._fnCalculateEnd(a);for(;r<a._iDisplayStart;)a._iDisplayStart=a._iDisplayLength>=0?a._iDisplayStart-a._iDisplayLength:0,a._iDisplayStart<0&&(a._iDisplayStart=0),K.oApi._fnCalculateEnd(a);K.oApi._fnDraw(a),C=f}var u=b(o);S=o,x=u[0],L=u[1];var c,p,y,g,D,N,k;if(l&&(c=n(e).height(),p=n(e).width(),y=n(t).scrollTop(),g=n(t).scrollLeft(),D=o.offsetHeight,N=o.offsetWidth,k=h(o),!K||void 0===a.oScroll||""===a.oScroll.sX&&""===a.oScroll.sY||(k[1]-=n(a.nTable.parentNode).scrollTop(),k[0]-=n(a.nTable.parentNode).scrollLeft()),k[1]+D>y+c?v(k[1]+D-c):k[1]<y&&v(k[1]),k[0]+N>g+p?T(k[0]+N-p):k[0]<g&&T(k[0])),K&&void 0!==a.oScroll&&(""!==a.oScroll.sX||""!==a.oScroll.sY)){var E=a.nTable.parentNode;c=E.clientHeight,p=E.clientWidth,y=E.scrollTop,g=E.scrollLeft,D=o.offsetHeight,N=o.offsetWidth,o.offsetTop+D>c+y?E.scrollTop=o.offsetTop+D-c:o.offsetTop<y&&(E.scrollTop=o.offsetTop),o.offsetLeft+N>p+g?E.scrollLeft=o.offsetLeft+N-p:o.offsetLeft<g&&(E.scrollLeft=o.offsetLeft)}d(),i("focus",x,L)}}function f(){s(S),x=null,L=null,S=null,p()}function s(e){n(e).removeClass(_),n(e).parent().removeClass(_),i("blur",x,L)}function u(e){for(var t=this;"TD"!=t.nodeName;)t=t.parentNode;r(t),d()}function c(e){if(k.block||!C)return!0;if(e.metaKey||e.altKey||e.ctrlKey)return!0;var t,n,o,l=N.getElementsByTagName("tr")[0].getElementsByTagName("td").length;if(K){o=K.aiDisplay.length;var a=m(S);if(null===a)return;x=a[0],L=a[1]}else o=N.getElementsByTagName("tr").length;var s=9==e.keyCode&&e.shiftKey?-1:e.keyCode;switch(s){case 13:return e.preventDefault(),e.stopPropagation(),i("action",x,L),!0;case 27:if(!i("esc",x,L))return void f();t=x,n=L;break;case-1:case 37:if(x>0)t=x-1,n=L;else{if(!(L>0))return!(-1!=s||!g||(w=!0,D.focus(),setTimeout(function(){w=!1},0),C=!1,f(),0));t=l-1,n=L-1}break;case 38:if(!(L>0))return!1;t=x,n=L-1;break;case 36:t=x,n=0;break;case 33:t=x,(n=L-10)<0&&(n=0);break;case 9:case 39:if(x<l-1)t=x+1,n=L;else{if(!(L<o-1))return!(9!=s||!g||(w=!0,D.focus(),setTimeout(function(){w=!1},0),C=!1,f(),0));t=0,n=L+1}break;case 40:if(!(L<o-1))return!1;t=x,n=L+1;break;case 35:t=x,n=o-1;break;case 34:t=x,(n=L+10)>o-1&&(n=o-1);break;default:return!0}return r(y(t,n)),!1}function d(){C||(C=!0)}function p(){C=!1}function y(e,t){return K?void 0!==K.aoData[K.aiDisplay[t]]?K.aoData[K.aiDisplay[t]].nTr.getElementsByTagName("td")[e]:null:n("tr:eq("+t+")>td:eq("+e+")",N)[0]}function b(e){return K?[n("td",e.parentNode).index(e),n("tr",e.parentNode.parentNode).index(e.parentNode)+K._iDisplayStart]:[n("td",e.parentNode).index(e),n("tr",e.parentNode.parentNode).index(e.parentNode)]}function v(e){t.documentElement.scrollTop=e,t.body.scrollTop=e}function T(e){t.documentElement.scrollLeft=e,t.body.scrollLeft=e}function h(e){var t=0,n=0;if(e.offsetParent)for(t=e.offsetLeft,n=e.offsetTop,e=e.offsetParent;e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return[t,n]}function m(e){for(var t=0,n=K.aiDisplay.length;t<n;t++)for(var o=K.aoData[K.aiDisplay[t]].nTr.getElementsByTagName("td"),l=0,a=o.length;l<a;l++)if(o[l]==e)return[l,t];return null}this.block=!1,this.event={remove:{}},this.fnGetCurrentPosition=function(){return[x,L]},this.fnGetCurrentData=function(){return S.innerHTML},this.fnGetCurrentTD=function(){return S},this.fnSetPosition=function(e,t){r("object"==typeof e&&e.nodeName?e:y(e,t))},this.fnBlur=function(){f()};var g,D,N=null,S=null,x=null,L=null,k=null,_="focus",C=!1,E={action:[],esc:[],focus:[],blur:[]},K=null,w=!1;for(var B in E)B&&(this.event[B]=function(e){return function(t,n,o){if(null!==t&&"number"!=typeof t||null!==n&&"number"!=typeof n||"function"!=typeof o)if("object"==typeof t&&"function"==typeof n){var a=b(t);l(e,a[0],a[1],n)}else alert("Unhandable event type was added: x"+t+"  y:"+n+"  z:"+o);else l(e,t,n,o)}}(B),this.event.remove[B]=function(e){return function(t,n,o){if(null!==t&&"number"!=typeof arguments[0]||null!==n&&"number"!=typeof arguments[1])if("object"==typeof arguments[0]){var l=b(t);"function"==typeof arguments[1]?a(e,l[0],l[1],n):a(e,l[0],l[1])}else alert("Unhandable event type was removed: x"+t+"  y:"+n+"  z:"+o);else"function"==typeof arguments[2]?a(e,t,n,o):a(e,t,n)}}(B));var P,j;void 0===o?(P=n("table.KeyTable")[0],j=null):n.isPlainObject(o)?(P=o.table,j=o.datatable):P=(j=new n.fn.dataTable.Api(o).settings()[0]).nTable,function(e,o,l,a){if(k=a,void 0===l&&(l={}),void 0===l.focus&&(l.focus=[0,0]),l.table=e,n(l.table).addClass("KeyTable"),void 0!==l.focusClass&&(_=l.focusClass),void 0!==o&&(K=o),void 0===l.initScroll&&(l.initScroll=!0),void 0===l.form&&(l.form=!1),g=l.form,N=l.table.getElementsByTagName("tbody")[0],g){var i=t.createElement("div");D=t.createElement("input"),i.style.height="1px",i.style.width="0px",i.style.overflow="hidden",void 0!==l.tabIndex&&(D.tabIndex=l.tabIndex),i.appendChild(D),l.table.parentNode.insertBefore(i,l.table.nextSibling),n(D).focus(function(){w||(C=!0,w=!1,void 0!==l.focus.nodeName?r(l.focus,l.initScroll):r(y(l.focus[0],l.focus[1]),l.initScroll),setTimeout(function(){D.blur()},0))}),C=!1}else void 0!==l.focus.nodeName?r(l.focus,l.initScroll):r(y(l.focus[0],l.focus[1]),l.initScroll),d();n(t).bind("keydown",c),K?n(K.nTable).on("click","td",u):n(N).on("click","td",u),n(t).click(function(e){for(var t=e.target,n=!1;t;){if(t==l.table){n=!0;break}t=t.parentNode}n||f()})}(P,j,o,this)},KeyTable.version="1.2.0",n.fn.dataTable.KeyTable=KeyTable,n.fn.DataTable.KeyTable=KeyTable}(jQuery,jQuery.fn.dataTable)}(window,document);
