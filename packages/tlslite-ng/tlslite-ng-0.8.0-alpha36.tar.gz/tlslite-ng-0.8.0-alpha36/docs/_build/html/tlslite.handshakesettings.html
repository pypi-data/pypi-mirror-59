
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>tlslite.handshakesettings module &#8212; tlslite-ng 0.8.0-alpha36 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-tlslite.handshakesettings">
<span id="tlslite-handshakesettings-module"></span><h1>tlslite.handshakesettings module<a class="headerlink" href="#module-tlslite.handshakesettings" title="Permalink to this headline">¶</a></h1>
<p>Class for setting handshake parameters.</p>
<dl class="class">
<dt id="tlslite.handshakesettings.HandshakeSettings">
<em class="property">class </em><code class="descclassname">tlslite.handshakesettings.</code><code class="descname">HandshakeSettings</code><a class="headerlink" href="#tlslite.handshakesettings.HandshakeSettings" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class encapsulates various parameters that can be used with
a TLS handshake.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>minKeySize</strong> (<em>int</em>) – <p>The minimum bit length for asymmetric keys.</p>
<p>If the other party tries to use SRP, RSA, or Diffie-Hellman
parameters smaller than this length, an alert will be
signalled.  The default is 1023.</p>
</li>
<li><strong>maxKeySize</strong> (<em>int</em>) – <p>The maximum bit length for asymmetric keys.</p>
<p>If the other party tries to use SRP, RSA, or Diffie-Hellman
parameters larger than this length, an alert will be signalled.
The default is 8193.</p>
</li>
<li><strong>cipherNames</strong> (<em>list</em>) – <p>The allowed ciphers.</p>
<p>The allowed values in this list are ‘chacha20-poly1305’, ‘aes256gcm’,
‘aes128gcm’, ‘aes256’, ‘aes128’, ‘3des’, ‘chacha20-poly1305_draft00’,
‘null’ and
‘rc4’.  If these settings are used with a client handshake, they
determine the order of the ciphersuites offered in the ClientHello
message.</p>
<p>If these settings are used with a server handshake, the server will
choose whichever ciphersuite matches the earliest entry in this
list.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If ‘3des’ is used in this list, but TLS Lite can’t find an
add-on library that supports 3DES, then ‘3des’ will be silently
removed.</p>
</div>
<p>The default value is list that excludes ‘rc4’, ‘null’ and
‘chacha20-poly1305_draft00’.</p>
</li>
<li><strong>macNames</strong> (<em>list</em>) – <p>The allowed MAC algorithms.</p>
<p>The allowed values in this list are ‘sha384’, ‘sha256’, ‘aead’, ‘sha’
and ‘md5’.</p>
<p>The default value is list that excludes ‘md5’.</p>
</li>
<li><strong>certificateTypes</strong> (<em>list</em>) – <p>The allowed certificate types.</p>
<p>The only allowed certificate type is ‘x509’.  This list is only used
with a
client handshake.  The client will advertise to the server which
certificate
types are supported, and will check that the server uses one of the
appropriate types.</p>
</li>
<li><strong>minVersion</strong> (<em>tuple</em>) – <p>The minimum allowed SSL/TLS version.</p>
<p>This variable can be set to (3, 0) for SSL 3.0, (3, 1) for TLS 1.0,
(3, 2) for
TLS 1.1, or (3, 3) for TLS 1.2.  If the other party wishes to use a
lower
version, a protocol_version alert will be signalled.  The default is
(3, 1).</p>
</li>
<li><strong>maxVersion</strong> (<em>tuple</em>) – <p>The maximum allowed SSL/TLS version.</p>
<p>This variable can be set to (3, 0) for SSL 3.0, (3, 1) for TLS 1.0,
(3, 2) for TLS 1.1, or (3, 3) for TLS 1.2.  If the other party wishes
to use a
higher version, a protocol_version alert will be signalled.  The
default is (3, 3).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Some servers may (improperly) reject clients which offer
support
for TLS 1.1 or higher.  In this case, try lowering maxVersion to
(3, 1).</p>
</div>
</li>
<li><strong>useExperimentalTackExtension</strong> (<em>bool</em>) – <p>Whether to enabled TACK support.</p>
<p>Note that TACK support is not standardized by IETF and uses a temporary
TLS Extension number, so should NOT be used in production software.</p>
</li>
<li><strong>sendFallbackSCSV</strong> (<em>bool</em>) – Whether to, as a client, send FALLBACK_SCSV.</li>
<li><strong>rsaSigHashes</strong> (<em>list</em>) – <p>List of hashes supported (and advertised as such) for
TLS 1.2 signatures over Server Key Exchange or Certificate Verify with
RSA signature algorithm.</p>
<p>The list is sorted from most wanted to least wanted algorithm.</p>
<p>The allowed hashes are: “md5”, “sha1”, “sha224”, “sha256”,
“sha384” and “sha512”. The default list does not include md5.</p>
</li>
<li><strong>ecdsaSigHashes</strong> (<em>list</em>) – <p>List of hashes supported (and advertised as such) for
TLS 1.2 signatures over Server Key Exchange or Certificate Verify with
ECDSA signature algorithm.</p>
<p>The list is sorted from most wanted to least wanted algorithm.</p>
<p>The allowed hashes are: “sha1”, “sha224”, “sha256”,
“sha384” and “sha512”.</p>
</li>
<li><strong>eccCurves</strong> (<em>list</em>) – List of named curves that are to be supported</li>
<li><strong>useEncryptThenMAC</strong> (<em>bool</em>) – whether to support the encrypt then MAC extension
from RFC 7366. True by default.</li>
<li><strong>useExtendedMasterSecret</strong> (<em>bool</em>) – whether to support the extended master
secret calculation from RFC 7627. True by default.</li>
<li><strong>requireExtendedMasterSecret</strong> (<em>bool</em>) – whether to require negotiation of
extended master secret calculation for successful connection. Requires
useExtendedMasterSecret to be set to true. False by default.</li>
<li><strong>defaultCurve</strong> (<em>str</em>) – curve that will be used by server in case the client
did not advertise support for any curves. It does not have to be the
first curve for eccCurves and may be distinct from curves from that
list.</li>
<li><strong>keyShares</strong> (<em>list</em>) – list of TLS 1.3 key shares to include in Client Hello</li>
<li><strong>padding_cb</strong> (<em>func</em>) – Callback to function computing number of padding bytes
for TLS 1.3. Signature is cb_func(msg_size, content_type, max_size).</li>
<li><strong>pskConfigs</strong> (<em>list of tuples</em>) – list of tuples, first element of the tuple is the
human readable, UTF-8 encoded, “identity” of the associated secret
(bytearray, can be empty for TLS 1.2 and earlier), second element is
the binary secret (bytearray), third is an optional parameter
specifying the PRF hash to be used in TLS 1.3 (‘sha256’ or ‘sha384’)</li>
<li><strong>ticketKeys</strong> (<em>list of bytearray</em>) – keys to be used for encrypting and decrypting session
tickets. First entry is the encryption key for new tickets and the
default decryption key, subsequent entries are the fallback keys
allowing for key rollover. The keys need to be of size appropriate
for a selected cipher in ticketCipher, 32 bytes for ‘aes256gcm’ and
‘chacha20-poly1305’, 16 bytes for ‘aes128-gcm’.
New keys should be generated regularly and replace old ones. Key use
time should generally not be longer than 24h and key life-time should
not be longer than 48h.
Leave empty to disable session ticket support on server side.</li>
<li><strong>ticketCipher</strong> (<em>str</em>) – name of the cipher used for encrypting the session
tickets. ‘aes256gcm’ by default, ‘aes128gcm’ or ‘chacha20-poly1305’
alternatively.</li>
<li><strong>ticketLifetime</strong> (<em>int</em>) – maximum allowed lifetime of ticket encryption key,
in seconds. 1 day by default</li>
<li><strong>psk_modes</strong> (<em>list</em>) – acceptable modes for the PSK key exchange in TLS 1.3</li>
<li><strong>max_early_data</strong> (<em>int</em>) – maximum number of bytes acceptable for 0-RTT
early_data processing. In other words, how many bytes will the server
try to process, but ignore, in case the Client Hello includes
early_data extension.</li>
<li><strong>use_heartbeat_extension</strong> (<em>bool</em>) – whether to support heartbeat extension from
RFC 6520. True by default.</li>
<li><strong>heartbeat_response_callback</strong> (<em>func</em>) – Callback to function when Heartbeat
response is received.</li>
<li><a class="reference internal" href="tlslite.constants.html#tlslite.constants.ExtensionType.record_size_limit" title="tlslite.constants.ExtensionType.record_size_limit"><strong>record_size_limit</strong></a> (<em>int</em>) – maximum size of records we are willing to process
(value advertised to the other side). It must not be larger than
2**14+1 (the maximum for TLS 1.3) and will be reduced to 2**14 if TLS
1.2 or lower is the highest enabled version. Must not be set to values
smaller than 64. Set to None to disable support for the extension.
See also: RFC 8449.</li>
<li><strong>keyExchangeNames</strong> (<em>list</em>) – Enabled key exchange types for the connection,
influences selected cipher suites.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tlslite.handshakesettings.HandshakeSettings.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.handshakesettings.HandshakeSettings.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise default values for settings.</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.handshakesettings.HandshakeSettings.getCertificateTypes">
<code class="descname">getCertificateTypes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.handshakesettings.HandshakeSettings.getCertificateTypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get list of certificate types as IDs</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.handshakesettings.HandshakeSettings.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.handshakesettings.HandshakeSettings.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate the settings, filter out unsupported ciphersuites and return
a copy of object. Does not modify the original object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#tlslite.handshakesettings.HandshakeSettings" title="tlslite.handshakesettings.HandshakeSettings">HandshakeSettings</a></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a self-consistent copy of settings</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><strong>ValueError</strong> – when settings are invalid, insecure or unsupported.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tlslite.handshakesettings.Keypair">
<em class="property">class </em><code class="descclassname">tlslite.handshakesettings.</code><code class="descname">Keypair</code><span class="sig-paren">(</span><em>key=None</em>, <em>certificates=()</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.handshakesettings.Keypair" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Key, certificate and related data.</p>
<p>Stores also certificate associate data like OCSPs and transparency info.
TODO: add the above</p>
<p>First certificate in certificates needs to match key, remaining should
build a trust path to a root CA.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> (<a class="reference internal" href="tlslite.utils.rsakey.html#tlslite.utils.rsakey.RSAKey" title="tlslite.utils.rsakey.RSAKey"><em>RSAKey</em></a><em> or </em><em>ECDSAKey</em>) – private key</li>
<li><strong>certificates</strong> (<em>list of X509</em>) – the certificates to send to peer if the key is selected
for use. The first one MUST include the public key of the <code class="docutils literal notranslate"><span class="pre">key</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tlslite.handshakesettings.Keypair.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>key=None</em>, <em>certificates=()</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.handshakesettings.Keypair.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__init__(…) initializes x; see help(type(x)) for signature</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.handshakesettings.Keypair.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.handshakesettings.Keypair.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check the keypair.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tlslite.handshakesettings.VirtualHost">
<em class="property">class </em><code class="descclassname">tlslite.handshakesettings.</code><code class="descname">VirtualHost</code><a class="headerlink" href="#tlslite.handshakesettings.VirtualHost" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration of keys and certs for a single virual server.</p>
<p>This class encapsulates keys and certificates for hosts specified by
server_name (SNI) and ALPN extensions.</p>
<p>TODO: support SRP as alternative to certificates
TODO: support PSK as alternative to certificates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="tlslite.basedb.html#tlslite.basedb.BaseDB.keys" title="tlslite.basedb.BaseDB.keys"><strong>keys</strong></a> (list of <span class="xref std std-ref">~Keypair</span>) – List of certificates and keys to be used in this
virtual host. First keypair able to server ClientHello will be used.</li>
<li><strong>hostnames</strong> (<em>set of bytes</em>) – all the hostnames that server supports
please use <span class="xref std std-ref">matches_hostname</span> to verify if the VirtualHost
can serve a request to a given hostname as that allows wildcard hosts
that always reply True.</li>
<li><strong>trust_anchors</strong> (<em>list of X509</em>) – list of CA certificates supported for client
certificate authentication, sent in CertificateRequest</li>
<li><strong>app_protocols</strong> – all the application protocols that the server supports
(for ALPN)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tlslite.handshakesettings.VirtualHost.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.handshakesettings.VirtualHost.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up default configuration.</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.handshakesettings.VirtualHost.matches_hostname">
<code class="descname">matches_hostname</code><span class="sig-paren">(</span><em>hostname</em><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.handshakesettings.VirtualHost.matches_hostname" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the virtual host can serve hostname</p>
</dd></dl>

<dl class="method">
<dt id="tlslite.handshakesettings.VirtualHost.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tlslite.handshakesettings.VirtualHost.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Sanity check the settings</p>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">tlslite-ng</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Hubert Kario.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/tlslite.handshakesettings.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>