Metadata-Version: 2.1
Name: django-guid
Version: 0.3.0
Summary: Middleware that makes a request GUID available from anywhere and injects it into your logs.
Home-page: https://github.com/JonasKs/django-guid
Author: Jonas KrÃ¼ger Svensson
Author-email: jonas-ks@hotmail.com
License: BSD
Download-URL: https://pypi.python.org/pypi/django-guid
Keywords: django,logging,request,web,uuid,guid
Platform: OS Independent
Classifier: Development Status :: 5 - Production/Stable
Classifier: Development Status :: 5 - Production/Stable
Classifier: Environment :: Web Environment
Classifier: Framework :: Django
Classifier: Framework :: Django :: 2.2
Classifier: Framework :: Django :: 3.0
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: BSD License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python
Classifier: Programming Language :: Python :: 3.6
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Topic :: Internet :: WWW/HTTP
Classifier: Topic :: Internet :: WWW/HTTP :: Dynamic Content
Classifier: Topic :: Internet :: WWW/HTTP :: WSGI
Classifier: Topic :: Software Development
Classifier: Topic :: Software Development :: Libraries
Classifier: Topic :: Software Development :: Libraries :: Application Frameworks
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Dist: Django (>=2.2)

GUID injection for Django
=========================

.. image:: https://img.shields.io/pypi/v/django-guid.svg
    :target: https://pypi.python.org/pypi/django-guid
.. image:: https://img.shields.io/pypi/pyversions/django-guid.svg
    :target: https://pypi.python.org/pypi/django-guid#downloads
.. image:: https://img.shields.io/pypi/djversions/django-guid.svg
    :target: https://pypi.python.org/pypi/django-guid

Django GUID stores a GUID to an object, making it accessible by using the ID of the current thread.
The GUID is accessible from anywhere within the application throughout a request,
allowing us to inject it into the logs.

* Free software: BSD License
* Homepage: https://github.com/JonasKs/django-guid
* Documentation: Incoming


Settings
--------

* :code:`SKIP_CLEANUP`
        After the request is done, the GUID is deleted to avoid memory leaks. Memory leaks can happen in the
        case of many threads, or especially when using Gunicorn :code:`max_requests` or similar settings,
        where the number of thread IDs can potentially scale for ever.
        Having clean up enabled ensures we can not have memory leaks, but comes at the cost that anything that happens
        after this middleware will not have the GUID attached, such as :code:`django.request` or :code:`django.server`
        logs. If you do not want clean up of GUIDs and know what you're doing, you can enable :code:`SKIP_CLEANUP`.

    Default: False

* :code:`GUID_HEADER_NAME`
        The name of the GUID to look for in a header in an incoming request. Remember that it's case insensitive.

    Default: Correlation-ID

* :code:`VALIDATE_GUID`
        Whether the :code:`GUID_HEADER_NAME` should be validated or not.
        If the GUID sent to through the header is not a valid GUID (:code:`uuid.uuid4`).

    Default: True


Installation
------------

Python package::

    pip install django-guid

In your project's :code:`settings.py` add these settings:

(If these settings are confusing, please have a look in the demo project
`settings.py <https://github.com/JonasKs/django-guid/blob/master/demoproj/settings.py>`_ file for a complete setup.)


Add the middleware to the middleware (To ensure the GUID to be injected in all logs, put it on top)

.. code-block:: python

    MIDDLEWARE = [
        'django_guid.middleware.GuidMiddleware',
        ...
     ]


Add a filter to your ``LOGGING``:

.. code-block:: python

    LOGGING = {
        'filters': {
            'correlation_id': {
                '()': 'django_guid.log_filters.CorrelationId'
            }
        }
    }


and put that filter in your handler:

.. code-block:: python

    LOGGING = {
        'handlers': {
            'console': {
                'class': 'logging.StreamHandler',
                'formatter': 'medium',
                'filters': ['correlation_id'],
            }
        }
    }

and lastly make sure we add the new `correlation_id` filter to the formatters:

.. code-block:: python

    LOGGING = {
        'formatters': {
            'medium': {
                'format': '%(levelname)s %(asctime)s [%(correlation_id)s] %(name)s %(message)s'
            }
        }
    }


Inspired by `django-log-request-id <https://github.com/dabapps/django-log-request-id>`_ with a
`django-crequest <https://github.com/Alir3z4/django-crequest>`_ approach.


Changelog
=========

`0.3.0`_ - 2020-01-10
---------------------

**Features**

* Added a SKIP_CLEANUP setting

**Improvements**

* Improved all tests to be more verbose

* Made the README more correct, with more information and listing all the settings.


`0.2.3`_ - 2020-01-09
---------------------

**Improvements**

* Added tests written in `pytests`, 100% codecov

* Added Django2.2 and Django3 to github workflow as two steps

* Improved logging


`0.2.2`_ - 2019-12-21
---------------------

**Improvements**

* Removed the mandatory DJANGO_GUID settings in settings.py. Added an example project to demonstrate how to set the project up


`0.2.1`_ - 2019-12-21
---------------------

**Improvements**

* Workflow added, better docstrings, easier to read flow


`0.2.0`_ - 2019-12-21
---------------------

**Features**

* Header name and header GUID validation can be specified through Django settings

2019-12-20
------------------

* Initial release


.. _0.2.0: https://github.com/jonasks/django-guid/compare/0.1.2...0.2.0
.. _0.2.1: https://github.com/jonasks/django-guid/compare/0.2.0...0.2.1
.. _0.2.2: https://github.com/jonasks/django-guid/compare/0.2.1...0.2.2
.. _0.2.3: https://github.com/jonasks/django-guid/compare/0.2.2...0.2.3
.. _0.3.0: https://github.com/jonasks/django-guid/compare/0.2.3...0.3.0

